From 1c9af3b1332c6839e93e1202aecb422ad64f7b5d Mon Sep 17 00:00:00 2001
From: Cristy <urban-warrior@imagemagick.org>
Date: Thu, 9 Mar 2017 07:27:42 -0500
Subject: [PATCH] CVE-2017-9098: use of uninitialized memory in RLE decoder

Reset memory for RLE decoder (patch provided by scarybeasts)

bug: https://scarybeastsecurity.blogspot.com/2017/05/bleed-continues-18-byte-file-14k-bounty.html
bug-debian: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=862967
origin: https://github.com/ImageMagick/ImageMagick/commit/1c358ffe0049f768dd49a8a889c1cbf99ac9849b
---
 coders/rle.c | 1 +
 1 file changed, 1 insertion(+)

diff --git a/coders/rle.c b/coders/rle.c
index 142eccbef..5279f451c 100644
--- a/coders/rle.c
+++ b/coders/rle.c
@@ -344,6 +344,7 @@ static Image *ReadRLEImage(const ImageInfo *image_info,ExceptionInfo *exception)
     pixel_info_length=image->columns*image->rows*
       MagickMax(number_planes_filled,4);
     pixels=(unsigned char *) GetVirtualMemoryBlob(pixel_info);
+    (void) ResetMagickMemory(pixels,0,pixel_info_length);
     if ((flags & 0x01) && !(flags & 0x02))
       {
         ssize_t
