From f19e5b049bfbc8d524b223961a02749e320dff47 Mon Sep 17 00:00:00 2001
From: Cristy <urban-warrior@imagemagick.org>
Date: Thu, 27 Jul 2017 12:41:33 -0400
Subject: [PATCH] Memory leak in mat coder (upstream 624)

bug-debian: https://bugs.debian.org/870023
bug: https://github.com/ImageMagick/ImageMagick/issues/624
origin: https://github.com/ImageMagick/ImageMagick/commit/5163756a1f829a561912dfdb74a0dae41d8ed8cf

(cherry picked from commit 5163756a1f829a561912dfdb74a0dae41d8ed8cf)
---
 coders/mat.c | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/coders/mat.c b/coders/mat.c
index c7de554f2..a0c189c84 100644
--- a/coders/mat.c
+++ b/coders/mat.c
@@ -1312,6 +1312,10 @@ done_reading:
           }
          }
        }
+    if (quantum_info != (QuantumInfo *) NULL)
+      quantum_info=DestroyQuantumInfo(quantum_info);
+    if (clone_info)
+      clone_info=DestroyImageInfo(clone_info);
   }
 
   RelinquishMagickMemory(BImgBuff);
